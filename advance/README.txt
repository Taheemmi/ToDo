This is all of the code, together. The other advance has split the code up for easier reading
